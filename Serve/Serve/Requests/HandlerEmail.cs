using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Net.Mail;
using RestPanda.Requests.Attributes;
using RestPanda.Requests;
using WebServer.Entity;
using System.Net;

namespace WebServer.Requests
{
    [RequestHandler]
    public class HandlerEmail
    {
        private static string FillTable()
        {
            var s = new StringBuilder("<table style=\"border-collapse: collapse\">" + Environment.NewLine);
            s.Append("<tr><th>id</th><th>ФИО</th><th>Возраст</th><th>Почта</th></tr>" + Environment.NewLine);
            foreach (var student in Student.Students)
            {
                s.Append("<tr>").Append($"<td>{student.id}</td>").Append($"<td>{student.fio}</td>")
                    .Append($"<td>{student.age}</td>").Append($"<td>{student.email}</td>").Append("</tr>" + Environment.NewLine);
            }
            s.Append("</table>");
            return s.ToString();
        }

        [Get]
        public static void CommitMessange(PandaRequest request, PandaResponse response)
        {
            var from = new MailAddress("service_phone_in_kirov@mail.ru", "Администрация сервисного центра по ремонту телефонов");
            var to = new MailAddress("ro.sym@yandex.ru", "Пользователь");
            var msg = new MailMessage(from, to);
            msg.Subject = "PDF file";
            msg.Attachments.Add(
                new Attachment("C://mail.pdf"));
            msg.Body = "Тестовое сообщение";
            using (var smtp = new SmtpClient("smtp.mail.ru", 587))
            {
                smtp.Credentials = new NetworkCredential("service_phone_in_kirov@mail.ru", "mLfsyTvqZpfEDu0VzUih");
                smtp.EnableSsl = true;
                smtp.Send(msg);
            }

            var msg2 = new MailMessage(from, to);
            msg2.Subject = "Html документ";
            msg2.Body = "<img src=\"data:image/jpeg;base64,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\" alt=\"Алеша\"/>" + Environment.NewLine;
            msg2.Body += FillTable();
            msg2.IsBodyHtml = true;
            using (var smtp = new SmtpClient("smtp.mail.ru", 587))
            {
                smtp.Credentials = new NetworkCredential("service_phone_in_kirov@mail.ru", "mLfsyTvqZpfEDu0VzUih");
                smtp.EnableSsl = true;
                smtp.Send(msg2);
            }
            response.Send("");
        }
    }
}
